import{a as s,j as t,F as te}from"./@mui-926ab118.js";import{r as n}from"./react-4cc0034d.js";import{a as h}from"./axios-1779699b.js";import{D as U}from"./react-datepicker-8937daa9.js";import{P as ae,B as se}from"./react-chartjs-2-fa95bfbc.js";import{C as ne,p as le,a as oe,b as re,c as ce,d as de,L as ie,A as me}from"./chart.js-3686957a.js";import{f as p}from"./date-fns-66ee9ebe.js";import"./clsx-0839fdbe.js";import"./react-transition-group-dd4db10c.js";import"./@babel-591e0485.js";import"./react-dom-502af1e5.js";import"./scheduler-765c72db.js";import"./@emotion-4d3fcc43.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./stylis-79144faa.js";import"./@floating-ui-07943c42.js";import"./@kurkle-36ca2f10.js";ne.register(le,oe,re,ce,de,ie,me);const Ue=()=>{const[o,j]=n.useState(null),[r,B]=n.useState(null),[f,F]=n.useState({}),[w,K]=n.useState({}),[D,P]=n.useState(null),[S,$]=n.useState(null),[y,L]=n.useState({total:"",knownVisits:[],unknownVisits:[]}),[R,u]=n.useState(!1),[k,g]=n.useState(null),[he,Y]=n.useState([]),[pe,O]=n.useState([]),[i,x]=n.useState(0),[W,_]=n.useState(!1),[q,v]=n.useState(!1),[b,C]=n.useState([]),[ue,N]=n.useState(null),[Z,E]=n.useState([]),[z,I]=n.useState([]),[G,A]=n.useState([]);n.useEffect(()=>{o&&r&&(V(o,r),M(o,r))},[o,r]);const V=async(e,a)=>{u(!0),g(null);try{const l=await h.get("http://localhost:5000/data-analysis",{params:{startDate:p(e,"yyyy-MM-dd"),endDate:p(a,"yyyy-MM-dd")}});F(l.data)}catch(l){g("Error fetching data."),console.error("Error fetching data:",l)}finally{u(!1)}},M=async(e,a)=>{u(!0),g(null);try{const l=await h.get("http://localhost:5000/unknown-data-analysis",{params:{startDate:p(e,"yyyy-MM-dd"),endDate:p(a,"yyyy-MM-dd")}});K(l.data)}catch(l){g("Error fetching unknown data."),console.error("Error fetching unknown data:",l)}finally{u(!1)}},T=async(e,a)=>{v(!0),_(!0),x(0),E([]),I([]),A([]);try{const l=a==="Known"?"http://localhost:5000/known-images-by-date":"http://localhost:5000/unknown-images-by-date",m=await h.get(l,{params:{date:e}});a==="Known"?(Y(m.data),C(m.data)):(O(m.data),C(m.data))}catch(l){console.error("Error fetching images:",l)}finally{v(!1)}},H=async e=>{try{const a=await h.get("http://localhost:5000/names-by-date",{params:{date:e}});console.log(a.data);const l=Array.from(new Set(a.data));E(l),N(e)}catch(a){console.error("Error fetching names:",a)}},J=async e=>{try{const a=await h.get("http://localhost:5000/untimestamp-by-date",{params:{date:e}});console.log("dt",a.data);const l=Array.from(new Set(a.data));A(l),N(e)}catch(a){console.error("Error fetching timestamps:",a)}},Q=async e=>{try{const a=await h.get("http://localhost:5000/timestamp-by-date",{params:{date:e}});console.log("dt",a.data);const l=Array.from(new Set(a.data));I(l),N(e)}catch(a){console.error("Error fetching timestamps:",a)}};n.useEffect(()=>{const e=Object.values(f).reduce((c,d)=>c+d,0),a=Object.values(w).reduce((c,d)=>c+d,0),l=Object.entries(f).map(([c,d])=>({date:c,count:d})),m=Object.entries(w).map(([c,d])=>({date:c,count:d}));P({labels:["Known Data","Unknown Data"],datasets:[{data:[e||1,a||1],backgroundColor:["#64C2A6","#2D87BB"]}]}),$({labels:["Known Data","Unknown Data"],datasets:[{label:"Total Visits",data:[e,a],backgroundColor:["#FF6384","#36A2EB"],borderColor:["#FF6384","#36A2EB"],borderWidth:1}]}),L({total:`${e} KNOWN  ,    ${a} UNKNOWN`,knownVisits:l,unknownVisits:m})},[f,w]);const X=()=>{i+5<b.length&&x(e=>e+1)},ee=()=>{i-1>=0&&x(e=>e-1)};return s("div",{children:[s("div",{className:"flex flex-col md:flex-row w-full gap-4 p-10",children:[s("div",{className:"bg-blue-50 shadow rounded-lg p-4 md:w-1/5 w-full flex flex-col text-center",style:{height:"400px",overflowY:"auto"},children:[t("h2",{className:"text-xl font-bold mb-4",children:"DATA SUMMARY"}),s("div",{className:"mb-4",children:[t("label",{className:"block font-semibold mb-2",children:"Start Date & Time:"}),t(U,{selected:o,onChange:e=>j(e),showTimeSelect:!0,timeFormat:"hh:mm aa",timeIntervals:15,dateFormat:"Pp",className:"w-full border rounded p-2",placeholderText:"Select Start Date & Time"})]}),s("div",{className:"mb-4",children:[t("label",{className:"block font-semibold mb-2",children:"End Date & Time:"}),t(U,{selected:r,onChange:e=>B(e),showTimeSelect:!0,timeFormat:"hh:mm aa",timeIntervals:15,dateFormat:"Pp",className:"w-full border rounded p-2",placeholderText:"Select End Date & Time"})]}),t("button",{className:"bg-blue-500 text-white py-1 px-4 font-bold rounded text-m mx-auto",onClick:()=>{V(o,r),M(o,r)},children:"Fetch Data"}),R&&t("p",{children:"Loading..."}),k&&t("p",{className:"text-red-500",children:k})]}),s("div",{className:"bg-blue-50 shadow rounded-lg px-4 md:w-4/5 w-full",style:{height:"400px",overflowY:"auto"},children:[t("h2",{className:"text-xl font-semibold mb-4",children:"Data Distribution"}),D?s("div",{style:{width:"100%",height:"280px"},children:[t(ae,{data:D,options:{plugins:{legend:{display:!0,position:"bottom"}},responsive:!0,maintainAspectRatio:!1}}),t("p",{className:"mt-2 font-bold text-xl text-center",children:y.total})]}):t("p",{children:"No data available for the selected range."})]}),s("div",{className:"bg-blue-50 shadow rounded-lg px-4 md:w-1/2 w-full",style:{height:"400px",overflowY:"auto"},children:[t("h2",{className:"text-xl font-semibold mb-4",children:"Data Distribution (Bar Chart)"}),S?t("div",{style:{width:"100%",height:"280px"},children:t(se,{data:S,options:{plugins:{legend:{display:!0,position:"top"}},responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}):t("p",{children:"No data available for the selected range."})]})]}),t("div",{className:"flex flex-col md:flex-row w-full gap-4 px-10",children:s("table",{className:"w-full table-auto border-separate ",children:[t("thead",{children:s("tr",{className:"bg-gray-100 hover:bg-gray-200",children:[t("th",{className:"border text-xl px-4 py-2 ",children:"Known and Unknown Visits"}),t("th",{className:"border text-xl px-4 py-2",children:"Known Visits by Date"}),t("th",{className:"border text-xl px-4 py-2",children:"Unknown Visits by Date"})]})}),s("tbody",{children:[s("tr",{className:"bg-green-50",children:[s("td",{className:"border px-4 py-2",style:{height:"200px",overflowY:"auto"},children:[s("p",{className:"mt-2 text-lg",children:[t("strong",{children:"Start Date & Time:"})," ",o?p(o,"MM/dd/yyyy, h:mm a"):"Not Selected"]}),s("p",{className:"mt-2 text-lg",children:[t("strong",{children:"End Date & Time:"})," ",r?p(r,"MM/dd/yyyy, h:mm a"):"Not Selected"]})]}),t("td",{className:"border px-4 py-2 text-lg",style:{height:"200px",overflowY:"auto"},children:y.knownVisits.map(e=>s("div",{className:"flex justify-between",children:[s("span",{children:[e.date,": ",t("span",{className:"font-bold",children:e.count})]}),t("button",{className:"bg-blue-400 hover:bg-blue-600 text-white py-1.5 px-2 text-sm rounded mb-1",onClick:()=>{T(e.date,"Known"),H(e.date),Q(e.date)},children:"View People"})]},e.date))}),t("td",{className:"border px-4 py-2 text-lg",style:{height:"200px",overflowY:"auto"},children:y.unknownVisits.map(e=>s("div",{className:"flex justify-between",children:[s("span",{children:[e.date,": ",t("span",{className:"font-bold",children:e.count})]}),t("button",{className:"bg-blue-400 hover:bg-blue-600 text-white py-1.5 px-2 text-sm rounded mb-1",onClick:()=>{T(e.date,"Unknown"),J(e.date)},children:"View People"})]},e.date))})]}),W&&t("tr",{children:t("td",{colSpan:"3",className:"border px-4 py-2",children:t("div",{className:"flex justify-center items-center",children:q?t("p",{children:"Loading images..."}):t(te,{children:b.length>0&&s("div",{className:"flex items-center gap-4 py-4",children:[t("button",{onClick:ee,disabled:i===0,className:"bg-blue-500 text-white py-2 px-4 rounded disabled:bg-gray-400",children:"Prev"}),t("div",{className:"flex flex-wrap gap-4 py-4",children:b.slice(i,i+5).map((e,a)=>s("div",{className:"flex flex-col items-center",children:[t("img",{src:`data:image/jpeg;base64,${e}`,alt:"Person",className:"w-72 h-72 object-cover rounded-lg"}),t("p",{className:"text-center font-semibold mt-4 text-xl",children:Z[a]}),t("p",{className:"text-center font-semibold mt-4 text-xl",children:z[a]}),t("p",{className:"text-center font-semibold mt-4 text-xl",children:G[a]})]},a))}),t("button",{onClick:X,disabled:i+5>=b.length,className:"bg-blue-500 text-white py-2 px-4 rounded disabled:bg-gray-400",children:"Next"})]})})})})})]})]})})]})};export{Ue as default};
